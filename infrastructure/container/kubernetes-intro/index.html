<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.18-DEV" />
    <meta name="description" content="hugo content for 1ambda.github.io">
<meta name="author" content="1ambda">

    <link rel="shortcut icon" href="https://1ambda.github.io/images/favicon.png" type="image/x-icon" />

    
    <title>Kubernetes: Intro</title>
    <link href="https://1ambda.github.io/css/nucleus.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/hybrid.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/featherlight.min.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/horsey.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/theme.css" rel="stylesheet">
    <link href="https://1ambda.github.io/css/hugo-theme.css" rel="stylesheet">
    <script src="https://1ambda.github.io/js/jquery-2.x.min.js"></script>
    <style type="text/css">:root #header + #content > #left > #rlblock_left
    {display:none !important;}</style>
    <link href="https://1ambda.github.io/css/theme-1ambda.css" rel="stylesheet">

  </head>
  <body class="" data-url="/infrastructure/container/kubernetes-intro/">
    <nav id="sidebar">
  <div id="header-wrapper">
    <div id="header">
      <a href="https://1ambda.github.io/home" style="color: white; margin-top:10px;">
  <div> <i class="fa fa-github fa-4x"></i> </div>
</a>
<div style="margin-top:5px; font-size: 25px;">1ambda</div>

    </div>
    
</div>


  <div class="highlightable">
    <ul class="topics">
      
      
        
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
      
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/home/">
        <a href="https://1ambda.github.io/home/">
          <span>
            
              <b>HOME</b>
            
             
            
           </span>
        </a>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  parent" data-nav-id="/infrastructure/">
        <a href="https://1ambda.github.io/infrastructure/">
          <span>
            
              <b>- </b>
            
             Infrastructure
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item active" data-nav-id="/infrastructure/container/kubernetes-intro/">
              <a href="https://1ambda.github.io/infrastructure/container/kubernetes-intro/">
                <span>Kubernetes: Intro     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/golang/">
        <a href="https://1ambda.github.io/golang/">
          <span>
            
              <b>- </b>
            
             Golang
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/golang/golang-tutorial/">
              <a href="https://1ambda.github.io/golang/golang-tutorial/">
                <span>Golang Tutorial     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/scala/">
        <a href="https://1ambda.github.io/scala/">
          <span>
            
              <b>-</b>
            
             Scala
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/scala/easy-scalaz-1/">
              <a href="https://1ambda.github.io/scala/easy-scalaz-1/">
                <span>Easy Scalaz 1     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/easy-scalaz-2/">
              <a href="https://1ambda.github.io/scala/easy-scalaz-2/">
                <span>Easy Scalaz 2     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/easy-scalaz-3/">
              <a href="https://1ambda.github.io/scala/easy-scalaz-3/">
                <span>Easy Scalaz 3     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/easy-scalaz-4/">
              <a href="https://1ambda.github.io/scala/easy-scalaz-4/">
                <span>Easy Scalaz 4     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/easy-scalaz-5/">
              <a href="https://1ambda.github.io/scala/easy-scalaz-5/">
                <span>Easy Scalaz 5     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/easy-scalaz-6/">
              <a href="https://1ambda.github.io/scala/easy-scalaz-6/">
                <span>Easy Scalaz 6     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-1/">
              <a href="https://1ambda.github.io/scala/functional-programming-1/">
                <span>Functional Programming 1     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-2/">
              <a href="https://1ambda.github.io/scala/functional-programming-2/">
                <span>Functional Programming 2     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-3/">
              <a href="https://1ambda.github.io/scala/functional-programming-3/">
                <span>Functional Programming 3     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-4/">
              <a href="https://1ambda.github.io/scala/functional-programming-4/">
                <span>Functional Programming 4     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-5/">
              <a href="https://1ambda.github.io/scala/functional-programming-5/">
                <span>Functional Programming 5     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-6/">
              <a href="https://1ambda.github.io/scala/functional-programming-6/">
                <span>Functional Programming 6     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/functional-programming-7/">
              <a href="https://1ambda.github.io/scala/functional-programming-7/">
                <span>Functional Programming 7     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/reactive-programming-1/">
              <a href="https://1ambda.github.io/scala/reactive-programming-1/">
                <span>Reactive Programming 1     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/reactive-programming-2/">
              <a href="https://1ambda.github.io/scala/reactive-programming-2/">
                <span>Reactive Programming 2     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/reactive-programming-3/">
              <a href="https://1ambda.github.io/scala/reactive-programming-3/">
                <span>Reactive Programming 3     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/reactive-programming-4/">
              <a href="https://1ambda.github.io/scala/reactive-programming-4/">
                <span>Reactive Programming 4     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/scala/reactive-programming-5/">
              <a href="https://1ambda.github.io/scala/reactive-programming-5/">
                <span>Reactive Programming 5     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/haskell/">
        <a href="https://1ambda.github.io/haskell/">
          <span>
            
              <b>- </b>
            
             Haskell
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-1/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-1/">
                <span>하스켈로 배우는 함수형 언어 1     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-2/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-2/">
                <span>하스켈로 배우는 함수형 언어 2     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-3/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-3/">
                <span>하스켈로 배우는 함수형 언어 3     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-4/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-4/">
                <span>하스켈로 배우는 함수형 언어 4     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-5/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-5/">
                <span>하스켈로 배우는 함수형 언어 5     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-6/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-6/">
                <span>하스켈로 배우는 함수형 언어 6     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-7/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-7/">
                <span>하스켈로 배우는 함수형 언어 7     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-8/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-8/">
                <span>하스켈로 배우는 함수형 언어 8     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/intro-to-haskell-9/">
              <a href="https://1ambda.github.io/haskell/intro-to-haskell-9/">
                <span>하스켈로 배우는 함수형 언어 9     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/haskell/poor-mans-concurrency-monad/">
              <a href="https://1ambda.github.io/haskell/poor-mans-concurrency-monad/">
                <span>Poor Man&#39;s Concurrency Monad     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/java/">
        <a href="https://1ambda.github.io/java/">
          <span>
            
              <b>- </b>
            
             Java
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/java/interview-questions-collection/">
              <a href="https://1ambda.github.io/java/interview-questions-collection/">
                <span>Interview Questions: Collection     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/javascript/">
        <a href="https://1ambda.github.io/javascript/">
          <span>
            
              <b>- </b>
            
             Javascript
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/javascript/javascript-inheritance/">
              <a href="https://1ambda.github.io/javascript/javascript-inheritance/">
                <span>Javascript Inheritance     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/javascript/tips-for-webpack-and-redux/">
              <a href="https://1ambda.github.io/javascript/tips-for-webpack-and-redux/">
                <span>Tips for Webpack and Redux     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/javascript/rest-api-put-vs-post/">
              <a href="https://1ambda.github.io/javascript/rest-api-put-vs-post/">
                <span>REST API: Put vs Post     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/oh-my-github/">
        <a href="https://1ambda.github.io/oh-my-github/">
          <span>
            
              <b>- </b>
            
             oh-my-github
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/oh-my-github/tutorial/">
              <a href="https://1ambda.github.io/oh-my-github/tutorial/">
                <span>10분만에 Github Profile 만들기     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/algorithm/">
        <a href="https://1ambda.github.io/algorithm/">
          <span>
            
              <b>- </b>
            
             Algorithm
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/design-and-analysis-part1-1/">
              <a href="https://1ambda.github.io/algorithm/design-and-analysis-part1-1/">
                <span>Design and Analysis: Divide &amp; Conquer     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/design-and-analysis-part1-2/">
              <a href="https://1ambda.github.io/algorithm/design-and-analysis-part1-2/">
                <span>Design and Analysis: Randomized Selection     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/design-and-analysis-part1-3/">
              <a href="https://1ambda.github.io/algorithm/design-and-analysis-part1-3/">
                <span>Design and Analysis: Graph Contraction Algorithm     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/design-and-analysis-part1-4/">
              <a href="https://1ambda.github.io/algorithm/design-and-analysis-part1-4/">
                <span>Design and Analysis: Graph Search and Connectivity     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/design-and-analysis-part1-5/">
              <a href="https://1ambda.github.io/algorithm/design-and-analysis-part1-5/">
                <span>Design and Analysis: Dijkstra, Heap, Red-Black Tree     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/design-and-analysis-part1-6/">
              <a href="https://1ambda.github.io/algorithm/design-and-analysis-part1-6/">
                <span>Design and Analysis: Hash Table, Universal Hashing, Bloom filters     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part1-1/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part1-1/">
                <span>Algorithm: Union Find     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part1-2/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part1-2/">
                <span>Algorithm: Analysis     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part2-1/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part2-1/">
                <span>Algorithm: Spanning Tree, Shortest Paths     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part2-2/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part2-2/">
                <span>Algorithm: Radix Sort, Suffix Sort     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part2-3/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part2-3/">
                <span>Algorithm: R-way, Ternary Tries     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part2-4/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part2-4/">
                <span>Algorithm: KMP, Boyer-Moore, Rabin-Karp     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part2-5/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part2-5/">
                <span>Algorithm: Maximum Flow (Ford-Fulkerson)     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/algorithm-part2-6/">
              <a href="https://1ambda.github.io/algorithm/algorithm-part2-6/">
                <span>Algorithm: Data Compression, Huffman, LZW     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/artificial-intelligence-cs188-1/">
              <a href="https://1ambda.github.io/algorithm/artificial-intelligence-cs188-1/">
                <span>AI (CS188): Intro     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/artificial-intelligence-cs188-2/">
              <a href="https://1ambda.github.io/algorithm/artificial-intelligence-cs188-2/">
                <span>AI (CS188): Search     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/artificial-intelligence-planning-1/">
              <a href="https://1ambda.github.io/algorithm/artificial-intelligence-planning-1/">
                <span>AI Planning 1: Intro     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/artificial-intelligence-planning-2/">
              <a href="https://1ambda.github.io/algorithm/artificial-intelligence-planning-2/">
                <span>AI Planning 2: A*. STRIPS     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/artificial-intelligence-planning-3/">
              <a href="https://1ambda.github.io/algorithm/artificial-intelligence-planning-3/">
                <span>AI Planning 3: PSP, PoP     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/algorithm/artificial-intelligence-planning-4/">
              <a href="https://1ambda.github.io/algorithm/artificial-intelligence-planning-4/">
                <span>AI Planning 4: STN, HTN     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/data-analysis/">
        <a href="https://1ambda.github.io/data-analysis/">
          <span>
            
              <b>- </b>
            
             Data Analysis
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-1/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-1/">
                <span>ML 01: Linear Regression     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-2/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-2/">
                <span>ML 02: Gradient Descent     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-3/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-3/">
                <span>ML 03: Logistic Regression     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-4/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-4/">
                <span>ML 04: Neural Network     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-5/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-5/">
                <span>ML 05: Back Propagation     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-6/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-6/">
                <span>ML 06: Practical Advices     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-7/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-7/">
                <span>ML 07: Support Vector Machine     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-8/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-8/">
                <span>ML 08: K-means, PCA Details     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-9/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-9/">
                <span>ML 09: Anomaly Detection, Recommender System     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/machine-learning-week-10/">
              <a href="https://1ambda.github.io/data-analysis/machine-learning-week-10/">
                <span>ML 10: Stochastic Gradient, Synthetic Data, Ceiling Analysis     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/intro-to-data-science-1/">
              <a href="https://1ambda.github.io/data-analysis/intro-to-data-science-1/">
                <span>Intro to Data Science 1     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/intro-to-data-science-2/">
              <a href="https://1ambda.github.io/data-analysis/intro-to-data-science-2/">
                <span>Intro to Data Science 2     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/intro-to-data-science-3/">
              <a href="https://1ambda.github.io/data-analysis/intro-to-data-science-3/">
                <span>Intro to Data Science 3     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/intro-to-data-science-4/">
              <a href="https://1ambda.github.io/data-analysis/intro-to-data-science-4/">
                <span>Intro to Data Science 4     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/process-mining-1/">
              <a href="https://1ambda.github.io/data-analysis/process-mining-1/">
                <span>Process Mining 1: Intro     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/process-mining-2/">
              <a href="https://1ambda.github.io/data-analysis/process-mining-2/">
                <span>Process Mining 2: Alpha Algorithm     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/process-mining-3/">
              <a href="https://1ambda.github.io/data-analysis/process-mining-3/">
                <span>Process Mining 3: Metric, C-nets     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/process-mining-4/">
              <a href="https://1ambda.github.io/data-analysis/process-mining-4/">
                <span>Process Mining 4: Conformance Checking, Dotted Chart     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/process-mining-5/">
              <a href="https://1ambda.github.io/data-analysis/process-mining-5/">
                <span>Process Mining 5: Decision, Social, Organization Mining     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/pattern-discovery-1/">
              <a href="https://1ambda.github.io/data-analysis/pattern-discovery-1/">
                <span>Pattern Discovery 1: Apriori, FP Growth     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/pattern-discovery-2/">
              <a href="https://1ambda.github.io/data-analysis/pattern-discovery-2/">
                <span>Pattern Discovery 2: Null-invariant, Pattern-Fusion, Constaint     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/data-analysis/pattern-discovery-3/">
              <a href="https://1ambda.github.io/data-analysis/pattern-discovery-3/">
                <span>Pattern Discovery 3: Sequential Pattern Mining     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      

      
        
      
      
      

      <li class="dd-item  " data-nav-id="/cloud-computing/">
        <a href="https://1ambda.github.io/cloud-computing/">
          <span>
            
              <b>- </b>
            
             Cloud Computing
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-1/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-1/">
                <span>CC 01: Map Reduce     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-2/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-2/">
                <span>CC 02: Gossip Protocol     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-3/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-3/">
                <span>CC 03: Membership Protocol     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-4/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-4/">
                <span>CC 04: P2P Systems     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-5/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-5/">
                <span>CC 05: Global Snapshot     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-6/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-6/">
                <span>CC 06: Multicast     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/cloud-computing/cloud-computing-7/">
              <a href="https://1ambda.github.io/cloud-computing/cloud-computing-7/">
                <span>CC 07: Paxos     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
    </ul>
    <hr>
     
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>
    </section>
  </div>
</nav>

        <section id="body">
        <div id="overlay"></div>

        <div class="padding highlightable">

            <div id="top-bar">
              
                
                
                
              <div id="top-github-link">
                  <a class="github-link" href="https://github.com/1ambda/1ambda.github.io-hugo/edit/master/content/infrastructure/container/kubernetes-intro.md" target="blank">
                    <i class="fa fa-code-fork"></i>
                    Edit this page
                  </a>
              </div>
                
              
              <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                  <span id="sidebar-toggle-span">
                      <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                        <i class="fa fa-bars"></i>
                      </a>
                  </span>
                
                <span id="toc-menu"><a href=""><i class="fa fa-list-alt"></i></a></span>
                
                
                
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                    
                    
                <a href="https://1ambda.github.io/infrastructure/" itemprop="url"><span itemprop="title">Infrastructure</span></a> <i class="fa fa-angle-right"></i>
                    
                  
                
                  
                
                  
                
                  
                
                  
                
                <span itemprop="title"> Kubernetes: Intro</span>
              </div>
              
                  <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#kubernetes-intro">Kubernetes: Intro</a>
<ul>
<li><a href="#caution">Caution</a></li>
<li><a href="#kubernetes">Kubernetes</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#kubernetes-internal-abbreviated">Kubernetes Internal (abbreviated)</a></li>
<li><a href="#pod">Pod</a></li>
<li><a href="#service">Service</a></li>
<li><a href="#deployment">Deployment</a></li>
<li><a href="#pet-set">Pet Set</a></li>
<li><a href="#other-objects">Other Objects</a></li>
<li><a href="#etc">Etc</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

              

            </div>
            
    	        <div id="body-inner">
                
                <h1>Kubernetes: Intro</h1>
                



<p><img src="https://raw.githubusercontent.com/1ambda/1ambda.github.io/master/assets/images/infra-kubernetes/intro/logo.png" alt="" /></p>

<h2 id="kubernetes-intro">Kubernetes: Intro</h2>

<h3 id="caution">Caution</h3>

<ol>
<li><p>작성자는 Container 전문가가 아니며 최대한 정확한 내용을 기록하려 했으나, 주말동안 짧게 찾아본 내용이므로 오류가 있을 수 있습니다. Production 적용을 위해서는, 더 많은 자료를 참고 부탁드립니다</p></li>

<li><p>이하의 내용은 docker, docker-compose, docker-swarm 등에 대해 이해하고 있다는 가정 하에 쓰여졌습니다.
잘 모르신다면 <a href="https://training.docker.com/self-paced-training">Docker Self-Paced Online Learning</a> 을 보고 오시면 더욱 쉽게 이해할 수 있습니다.</p></li>

<li><p>이 글에서는 kubernetes 의 구성요소, 인터널 등을 간략히 다룹니다. <a href="http://autopilotpattern.io/">Autopilot Pattern</a> 등의 볼륨 매니지먼트 기술을 찾아 오셨다면, 아래의 글 참고 부탁드립니다.</p></li>
</ol>

<ul>
<li><a href="https://www.joyent.com/blog/persistent-storage-patterns">Joyent: Persistent storage patterns for Docker in Production</a></li>
<li><a href="https://www.joyent.com/blog/dbaas-simplicity-no-lock-in">Joyent: MySQL on Autopilot</a></li>
</ul>

<p><br/></p>

<h3 id="kubernetes">Kubernetes</h3>

<p><a href="kubernetes.io">kubernetes</a> (이하 k8s) 는 container orchestration 툴입니다.
(e.g <a href="https://docs.docker.com/swarm/overview/">docker-swarm</a>,  <a href="https://mesosphere.github.io/marathon/">marathon</a>)</p>

<ul>
<li>여러 host (<a href="http://kubernetes.io/docs/admin/node/">= node in k8s</a>) 를 묶어 클러스터를 구성하고</li>
<li>container 를 적절한 위치에 배포하고 (auto-placement)</li>
<li>container 가 죽으면 자동으로 복구하며 (auto-restart)</li>
<li>필요에 따라 container 를 매끄럽게 추가(scaling), 복제(replication), 업데이트(rolling update), 롤백(rollback) 할 수 있습니다</li>
<li>이 외에도 수 많은 기능이 있으며, <a href="http://kubernetes.io/docs/whatisk8s/">What is k8s?</a> 에서 확인할 수 있습니다</li>
</ul>

<p><br/></p>

<p>k8s 를 사용하려면, 다음과 같은 내용을 알아야 합니다.</p>

<ol>
<li>k8s object (e.g <a href="http://kubernetes.io/docs/user-guide/pods/">pod</a>, <a href="http://kubernetes.io/docs/user-guide/petset/">pet set</a>, <a href="http://kubernetes.io/docs/user-guide/services/">service</a>, <a href="http://kubernetes.io/docs/user-guide/labels/">selector</a> 등)</li>
<li>multi-host 위에서 container 실행시 고려해야 할 것들 (e.g service discovery, networking, volume management, log aggregation)<br /></li>
<li>k8s internal</li>
</ol>

<p>다행히도 문서가 장황하지 않습니다. 필요한 내용을, 필요한 만큼만 설명하고 있기 때문에 날 잡아서 쭈욱 읽기에도 괜찮습니다.</p>

<p><br/></p>

<p>내용을 설명하기에 앞서 짧게나마 느낀점을 요약하면 다음과 같습니다</p>

<ul>
<li>docker 1.12 기준으로 <a href="https://blog.docker.com/2016/06/docker-1-12-built-in-orchestration/">docker-swarm: built-in orchestration</a> 이 대폭 개선되었음에도 불구하고, k8s 가 더 많은 기능과 자세한 세팅을 제공합니다.
실제 production 적용시에 다양한 요구사항이 생길 수 밖에 없기 때문에, k8s 의 다양한 기능은 큰 장점으로 보입니다</li>
<li>GCE 를 쓰지 않아도 됩니다. github issue 를 살펴보다 보면 AWS 에서 사용하는 사람도 많은것 같습니다
(<a href="http://kubernetes.io/docs/getting-started-guides/aws/">running k8s on AWS</a>)
일부 기능들 (e.g Service type LoadBalancer) 을 사용할 수 없으나, 세팅이 많은 만큼 우회가 가능하며
AWS 를 직접 지원하기도 합니다. (e.g AWSElasticBlockStore, SSL 등 <del>대인배</del>)</li>
<li><a href="http://kubernetes.io/docs/user-guide/ingress/">ingress</a> 등의 기능과 Future Work 등을 보고 있노라면
정말 다양한 기능을 빠르게 추가하려고 노력한다는 느낌을 받습니다</li>
</ul>

<p>지금 production 에 적용할거라면 swarm 보다는 k8s 에 베팅하고 올라 타겠습니다. (물론 <a href="https://mesosphere.github.io/marathon/">marathone</a> 도 살펴보겠습니다만..)</p>

<p><br/></p>

<h3 id="getting-started">Getting Started</h3>

<ol>
<li><p>GCE 가입하신 후 <a href="http://kubernetes.io/docs/hellonode/">Kubernetes: Hello World Walkthrough</a> 를 진행하고 오시면 아래의 내용을 이해하시는데 더욱 도움이 됩니다.</p></li>

<li><p><a href="https://github.com/kubernetes/minikube/blob/master/README.md">minikube</a> 를 설치하면 로컬에서 k8s 를 실행해볼 수 있습니다.</p></li>

<li><p>kubectl 1.3.0+ 의 경우에는 bash 와 zsh completion 이 들어있습니다. 이걸 이용하면 편합니다. (<code>source &lt;(kubectl completion zsh)
</code>) gcloud 이용시 1.2.5 버전이 깔릴 수 있습니다. 버전이 낮을시 <a href="http://kubernetes.io/docs/user-guide/prereqs/">kubectl isntall</a> 참고하시어 설치하면 됩니다.</p></li>
</ol>

<pre><code>$ kubectl version

Client Version: version.Info{Major:&quot;1&quot;, Minor:&quot;3&quot;, GitVersion:&quot;v1.3.0&quot;, GitCommit:&quot;283137936a498aed572ee22af6774b6fb6e9fd94&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2016-07-01T19:26:38Z&quot;, GoVersion:&quot;go1.6.2&quot;, Compiler:&quot;gc&quot;, Platform:&quot;darwin/amd64&quot;}

Server Version: version.Info{Major:&quot;1&quot;, Minor:&quot;3&quot;, GitVersion:&quot;v1.3.3&quot;, GitCommit:&quot;c6411395e09da356c608896d3d9725acab821418&quot;, GitTreeState:&quot;dirty&quot;, BuildDate:&quot;1970-01-01T00:00:00Z&quot;, GoVersion:&quot;go1.6.2&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;}
</code></pre>

<p><br/></p>

<h3 id="kubernetes-internal-abbreviated">Kubernetes Internal (abbreviated)</h3>

<ul>
<li><a href="http://k8s.info/cs.html">k8s.info: Cheat Sheet</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/architecture.md">k8s design docs: Architecture</a></li>
</ul>

<p>시작 전에 간단히 구성 요소를 짚고 넘어가겠습니다. 아래의 설명 대신 위에 있는 링크를 읽고 오셔도 됩니다.</p>

<p><img src="https://raw.githubusercontent.com/1ambda/1ambda.github.io/master/assets/images/infra-kubernetes/intro/physical-layout.png" alt="" /></p>

<p>하나의 k8s 클러스터는 하나의 master 와 여러개의 node 로 구성되어 있습니다.
개발자는 kubectl 을 이용해서 master 에 명령을 내리고, node 를 관리합니다.
반면 사용자 (endpoint user) 는 node 에 접속해 서비스를 이용합니다.</p>

<p><img src="https://raw.githubusercontent.com/1ambda/1ambda.github.io/master/assets/images/infra-kubernetes/intro/arc_k8s_simple.jpg" alt="" /></p>

<p>조금 더 자세히 보면,</p>

<ul>
<li>master 에는 작업을 위한 <a href="http://kubernetes.io/docs/admin/kube-apiserver/">api server</a>,
state 를 관리하기 위한 분산 저장소 (default 로 <a href="https://coreos.com/etcd/">etcd</a>),
<a href="http://kubernetes.io/docs/admin/kube-scheduler/">scheduler</a>,
<a href="http://kubernetes.io/docs/admin/kube-controller-manager/">controller manager</a> 등이 있습니다. (현재는 master 가 단일 노드이지만 추후 multi-node master 가 지원될 예정)</li>
<li>node (= minion) 에는 master 와 통신하는 <a href="http://kubernetes.io/docs/admin/kubelet/">kubelet</a> (agent, 현재는 containerized 되어있지 않음)이 있고,
외부의 요청을 처리하는 <a href="http://kubernetes.io/docs/admin/kube-proxy/">kube-proxy</a>,
container 리소스 모니터링을 위한 <a href="https://github.com/google/cadvisor">cAdviser</a> 등이 있습니다.</li>
</ul>

<p>이제 다시 큰 그림에서 보면, 다음과 같습니다.</p>

<p><img src="https://raw.githubusercontent.com/1ambda/1ambda.github.io/master/assets/images/infra-kubernetes/intro/arc_official.png" alt="" /></p>

<p><br/></p>

<h3 id="pod">Pod</h3>

<p><img src="https://raw.githubusercontent.com/1ambda/1ambda.github.io/master/assets/images/infra-kubernetes/intro/pods.png" alt="" /></p>

<p>하나 또는 여러개의 container 묶음을 <a href="http://kubernetes.io/docs/user-guide/pods">pod</a> 이라 부릅니다.
docker 에서 container 끼리 통신하려면 같은 network 위에 있도록 구성해야 하는 반면 (compose 도 동일), 하나의 pod 내에 있는 contianer 끼리는 그럴 필요가 없습니다.</p>

<ul>
<li>같은 IP 와 port space 를 가지기 때문에 <code>localhost</code> 로 통신이 가능하며</li>
<li><a href="http://kubernetes.io/docs/user-guide/volumes/">volume</a> 을 공유합니다
만약 어느 container 가 죽고 재시작되어도 pod 이 살아있는 한 shared volume 은 유지됩니다.</li>
</ul>

<blockquote>
<p>In terms of Docker constructs, a pod is modelled as a group of Docker containers with shared namespaces and shared volumes. PID namespace sharing is not yet implemented in Docker.</p>
</blockquote>

<p>pod 의 종료, 삭제 관련해서는 <a href="http://kubernetes.io/docs/user-guide/pods/#termination-of-pods">Termination of Pods</a> 를 참고하시면 됩니다.</p>

<p><br/></p>

<p>위에서 k8s 가 auto-restart 등을 해준다고 했었는데 테스트 해보겠습니다. 그 전에 먼저 클러스터가 정상적으로 세팅이 되었는지 확인해 보겠습니다. 저는 minikube 를 이용해서 로컬에서 실행했으므로 아래와 같은 결과가 나옵니다.
kubectl 을 여러 클러스터 중 하나에 붙어서 커맨드를 날릴 수 있도록 도와주는 docker-machine 정도로 이해하시면 됩니다. (단위가 다르지만)</p>

<pre><code>$ kubectl config view

apiVersion: v1
clusters:
- cluster:
    certificate-authority: /Users/1ambda/.minikube/ca.crt
    server: https://192.168.64.2:8443
  name: minikube
contexts:
- context:
    cluster: minikube
    user: minikube
  name: minikube
current-context: minikube
kind: Config
preferences: {}
users:
- name: minikube
  user:
    client-certificate: /Users/1ambda/.minikube/apiserver.crt
    client-key: /Users/1ambda/.minikube/apiserver.key
</code></pre>

<p>이제 아래와 같이 <code>nginx.yaml</code> 을 만들겠습니다.</p>

<pre><code class="language-yaml">apiVersion: v1
kind: ReplicationController
metadata:
  name: nginx
spec:
  replicas: 3
  selector:
    app: nginx
  template:
    metadata:
      name: nginx
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx
        ports:
        - containerPort: 80
</code></pre>

<p>이제 실행하면,</p>

<pre><code>$ kubectl create -f nginx.yaml
replicationcontroller &quot;nginx&quot; created

$ kubectl get replicationcontroller nginx
NAME      DESIRED   CURRENT   AGE
nginx     3         3         41s

$ kubectl get pods
NAME          READY     STATUS    RESTARTS   AGE
nginx-5aa7m   1/1       Running   0          45s
nginx-5frtc   1/1       Running   0          45s
nginx-sg1s5   1/1       Running   0          45s
</code></pre>

<p>pod 하나를 죽여보겠습니다. 재생성되는걸 확인할 수 있습니다.</p>

<pre><code>$ kubectl delete pod nginx-5aa7m
pod &quot;nginx-5aa7m&quot; deleted

$ kubectl get pods
NAME          READY     STATUS              RESTARTS   AGE
nginx-5frtc   1/1       Running             0          1m
nginx-6tub7   0/1       ContainerCreating   0          1s
nginx-sg1s5   1/1       Running             0          1m


$ kubectl get pods
NAME          READY     STATUS    RESTARTS   AGE
nginx-5frtc   1/1       Running   0          1m
nginx-6tub7   1/1       Running   0          5s
nginx-sg1s5   1/1       Running   0          1m
</code></pre>

<p><br/></p>

<h3 id="service">Service</h3>

<p><img src="https://raw.githubusercontent.com/1ambda/1ambda.github.io/master/assets/images/infra-kubernetes/intro/abstraction.png" alt="" /></p>

<p>pod 은 생성/삭제 될 수 있습니다. <a href="http://kubernetes.io/docs/user-guide/replication-controller/">replication-controller</a> 를 이용하면 심지어 동적으로도 scale up/down 이 가능한데,
이럴 경우 IP 가 변경/추가/제거 되므로, k8s 는 external &lt;-&gt; pods 이나 pods &lt;-&gt; pods 간의 안정적인 통신을 위해 <a href="http://kubernetes.io/docs/user-guide/services/">service</a> 라는 object 를 도입했습니다.</p>

<blockquote>
<p>Services provide a single, stable name and address for a set of pods. They act as basic load balancers.</p>
</blockquote>

<p>위 그림을 잘 보면, pod 에 있는 <a href="http://kubernetes.io/docs/user-guide/labels/">label</a> 과 동일한 컬러의 것이 service 에도 있고,
해당 service 가 같은 label 컬러를 가진 pod 을 위한 것임을 쉽게 알 수 있습니다.</p>

<p>위에서 생성한 nginx pods 를 위한 service 를 <code>nginx-svc.yaml</code> 이란 이름으로 만들어 보겠습니다. <code>selector</code> 를 잘 보세요.</p>

<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: nginx-svc
spec:
  ports:
    - name: nginx-svc
      port: 8090
      targetPort: 80
  type: NodePort
  selector:
    app: nginx
</code></pre>

<p>이제 생성하면,  <code>nginx-svc</code> service 의 EXTERNAL-IP 가 <code>&lt;nodes&gt;</code> 로 보입니다.
전체 node 에 대해서 외부 포트를 열어서 그런데,
<a href="http://kubernetes.io/docs/user-guide/services/#type-nodeport">NodePort</a>
대신 <a href="type-loadbalancer">LoadBalancer</a> (cloud provider 가 지원할 경우만 사용가능) 타입을 이용하거나 <a href="http://kubernetes.io/docs/user-guide/ingress/">ingress</a> 를 이용할 수 있습니다.</p>

<blockquote>
<p>As of Kubernetes v1.0, Services are a “layer 3” (TCP/UDP over IP) construct. In Kubernetes v1.1 the Ingress API was added (beta) to represent “layer 7” (HTTP) services.</p>
</blockquote>

<pre><code>$ kubectl create -f nginx-svc.yaml
service &quot;nginx-svc&quot; created

$ kubtctl get service
NAME         CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE
kubernetes   10.0.0.1     &lt;none&gt;        443/TCP    3d
nginx-svc    10.0.0.196   &lt;nodes&gt;       8090/TCP   1m

$ kubectl describe service nginx-svc
  ...
  Endpoints:              172.17.0.3:80,172.17.0.4:80,172.17.0.5:80
  
$ kubectl get node
NAME          STATUS    AGE
boot2docker   Ready     3d

$ kubectl describe node boot2docker | grep Address
Addresses:              192.168.64.2,192.168.64.2

$ curl 192.168.64.2:31968

 &lt;!DOCTYPE html&gt;
 &lt;html&gt;
 &lt;head&gt;
 &lt;title&gt;Welcome to nginx!&lt;/title&gt;
  ...
</code></pre>

<p><strong>192.168.64.2:31968</strong> 을 접근해보면, nginx 가 떠있음을 확인할 수 있습니다.</p>

<p><br/></p>

<p>pod 이 생성될때 active service 에 대해서 kubelet 이 service 의 IP, port 와 관련된 환경변수를 pod 에 주입합니다. (service 가 먼저 생성되어 있어야 함)
예를 들어 service name 이 <code>redis-master</code> 라면 다음과 같은 값들이 주입됩니다.</p>

<pre><code>REDIS_MASTER_SERVICE_HOST=10.0.0.11
REDIS_MASTER_SERVICE_PORT=6379
REDIS_MASTER_PORT=tcp://10.0.0.11:6379
REDIS_MASTER_PORT_6379_TCP=tcp://10.0.0.11:6379
REDIS_MASTER_PORT_6379_TCP_PROTO=tcp
REDIS_MASTER_PORT_6379_TCP_PORT=6379
REDIS_MASTER_PORT_6379_TCP_ADDR=10.0.0.11
</code></pre>

<p>하여 pod 간 통신에는 env variable 을 이용할 수 있으나, <a href="http://kubernetes.io/docs/user-guide/services/#dns">DNS</a> 를 이용하는 것이 더 권장됩니다.</p>

<p>추가적으로, label 값은 <a href="https://github.com/kubernetes/kubernetes/tree/master/examples/guestbook">kubernetes/example/guestbook</a> 처럼 붙이는 것이 권장됩니다.</p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: redis-master
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: redis
        role: master
        tier: backend
</code></pre>

<p><br/></p>

<h3 id="deployment">Deployment</h3>

<p><a href="http://kubernetes.io/docs/user-guide/deployments/">deployment</a> 는 <a href="http://kubernetes.io/docs/hellonode/">Kubernetes: Hello World Walkthrough</a> 를 진행하셨다면 감이 오셨을수도 있겠습니다.
rolling update, rollback 등을 지원하는 pod, replica set 입니다.</p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 3
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.7.9
        ports:
        - containerPort: 80
</code></pre>

<p>위와 같이 <code>nginx-deployment.yaml</code> 을 만들고, 배포하면</p>

<pre><code>$ kubectl delete replicationcontroller nginx
$ kubectl get pod

$ kubectl create -f nginx-deployment.yaml
deployment &quot;nginx-deployment&quot; created

$ kubectl get deployment
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   3         3         3            3           8h

$ kubectl get rs
NAME                          DESIRED   CURRENT   AGE
nginx-deployment-1159050644   3         3         8h

$ kubectl get pods
NAME                                READY     STATUS    RESTARTS   AGE
nginx-deployment-1159050644-1bhfw   1/1       Running   0          8h
nginx-deployment-1159050644-hxaxs   1/1       Running   0          8h
nginx-deployment-1159050644-zc5tc   1/1       Running   0          8h

$ kubectl rollout status deployment/nginx-deployment
  deployment nginx-deployment successfully rolled out
</code></pre>

<p>정상적으로 배포되었는지는 <strong>rollout status</strong> 커맨드를 이용해서 확인할 수 있습니다.</p>

<p>이제 container 의 nginx 버전을 올려보겠습니다.</p>

<pre><code>$ kubectl set image deployment/nginx-deployment nginx=nginx:1.9.1
deployment &quot;nginx-deployment&quot; image updated

$ # also, we can use `edit` 
$ # kubectl edit deployment/nginx-deployment

$ kubectl rollout status deployment/nginx-deployment
deployment nginx-deployment successfully rolled out

$ kubectl get deployment
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   3         3         3            3           9h

$ kubectl get rs
NAME                          DESIRED   CURRENT   AGE
nginx-deployment-1159050644   0         0         8h
nginx-deployment-671724942    3         3         1m
</code></pre>

<p>모든 pod 을 한번에 생성하고, 한번에 오래된 pod 을 죽이는 방식으로 일어나는 것이 아니라 rolling update 처럼 하나하나씩 진행됩니다.</p>

<blockquote>
<p>Deployment can ensure that only a certain number of Pods may be down while they are being updated. By default, it ensures that at least 1 less than the desired number of Pods are up (1 max unavailable).</p>

<p>Deployment can also ensure that only a certain number of Pods may be created above the desired number of Pods. By default, it ensures that at most 1 more than the desired number of Pods are up (1 max surge).</p>
</blockquote>

<pre><code>$ kubectl get pods
NAME                               READY     STATUS    RESTARTS   AGE
nginx-deployment-671724942-1hytl   1/1       Running   0          41s
nginx-deployment-671724942-7a0f1   1/1       Running   0          41s
nginx-deployment-671724942-jzgm0   1/1       Running   0          40s

$ kubectl describe deployments
Name:                   nginx-deployment
Namespace:              default
CreationTimestamp:      Sun, 07 Aug 2016 00:48:18 +0900
Labels:                 app=nginx
Selector:               app=nginx
Replicas:               3 updated | 3 total | 3 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  1 max unavailable, 1 max surge
OldReplicaSets:         &lt;none&gt;
NewReplicaSet:          nginx-deployment-671724942 (3/3 replicas created)
Events:
  FirstSeen     LastSeen        Count   From                            SubobjectPath   Type        Reason                   Message
  ---------     --------        -----   ----                            -------------   --------    ------                   -------
  51s           51s             1       {deployment-controller }                        Normal      ScalingReplicaSet        Scaled up replica set nginx-deployment-671724942 to 1
  51s           51s             1       {deployment-controller }                        Normal      ScalingReplicaSet        Scaled down replica set nginx-deployment-1159050644 to 2
  51s           51s             1       {deployment-controller }                        Normal      ScalingReplicaSet        Scaled up replica set nginx-deployment-671724942 to 2
  50s           50s             1       {deployment-controller }                        Normal      ScalingReplicaSet        Scaled down replica set nginx-deployment-1159050644 to 1
  50s           50s             1       {deployment-controller }                        Normal      ScalingReplicaSet        Scaled up replica set nginx-deployment-671724942 to 3
  50s           50s             1       {deployment-controller }                        Normal      ScalingReplicaSet        Scaled down replica set nginx-deployment-1159050644 to 0
</code></pre>

<p>보면 replica set 은 2개지만 <code>nginx-deployment-1159050644</code> 은 업데이트 전 버전인 1.7.9 pod 이 하나도 없고 (<strong>desired = 0</strong>), <code>nginx-deployment-671724942</code> 만 3 개의 pod 을 가지고 있습니다.
이전 replica set 을 유지하는 이유는 rollback 을 위해서 인데요</p>

<pre><code>$ kubectl rollout history deployment/nginx-deployment
deployments &quot;nginx-deployment&quot;:
REVISION        CHANGE-CAUSE
1               &lt;none&gt;
2               &lt;none&gt;
</code></pre>

<p>여기서 <code>CHANGE-CAUSE</code> 가 <strong>none</strong> 인 이유는 deployment 커맨드 이용해 <strong>--record</strong> 를 사용하지 않아서 그렇습니다. revision 값을 지정해 살펴보면</p>

<pre><code>$ kubectl rollout history deployment/nginx-deployment --revision=1
deployments &quot;nginx-deployment&quot; revision 1
  Labels:       app=nginx
        pod-template-hash=1159050644
  Containers:
   nginx:
    Image:      nginx:1.7.9
    Port:       80/TCP
    Environment Variables:      &lt;none&gt;
  No volumes.
  
$ kubectl rollout history deployment/nginx-deployment --revision=2
deployments &quot;nginx-deployment&quot; revision 2
  Labels:       app=nginx
        pod-template-hash=671724942
  Containers:
   nginx:
    Image:      nginx:1.9.1
    Port:       80/TCP
    Environment Variables:      &lt;none&gt;
  No volumes.
</code></pre>

<p>이제 rollback 해 보겠습니다.</p>

<pre><code>$ kubectl rollout undo deployment/nginx-deployment --to-revision=1
deployment &quot;nginx-deployment&quot; rolled back

$ kb get pods
NAME                                READY     STATUS              RESTARTS   AGE
nginx-deployment-1159050644-mg5e9   1/1       Running             0          2s
nginx-deployment-1159050644-vsoaw   1/1       Running             0          2s
nginx-deployment-1159050644-x0319   0/1       ContainerCreating   0          1s
nginx-deployment-671724942-1hytl    1/1       Terminating         0          23m

$ kb get deployment
NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   3         3         3            3           9h

$ kb get rs
NAME                          DESIRED   CURRENT   AGE
nginx-deployment-1159050644   3         3         9h
nginx-deployment-671724942    0         0         24m
</code></pre>

<p>이전 pod 이 죽고, 새로운 pod 이 생성되는 과정을 볼 수 있습니다.</p>

<p><br/></p>

<h3 id="pet-set">Pet Set</h3>

<p>stateless application 의 경우에는 기존의 pod, replica set 등을 이용해 쉽게 배포하고 확장할 수 있었지만,
 cluster 로 동작하는 경우에는 각 instance 간 networking 을 위해 reliable name (e.g index based, advertised hostname) 등의 기능이 필요했습니다.</p>

<p><a href="http://kubernetes.io/docs/user-guide/petset/">pet set</a> 은 stateful (e.g clustering) applications 의 지원을 위해 1.3 버전에서 alpha 기능으로 추가되었습니다. (see <a href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG.md#v130">CHANGELOG#1.3</a>)</p>

<p><a href="http://blog.kubernetes.io/2016/07/thousand-instances-of-cassandra-using-kubernetes-pet-set.html">1000 Instances of Cassandra using Kubernetes Pet Set</a> 에서는 alpha 기능인 pet set 을 이용해 1000 개의 카산드라 인스턴스를 배포하고 sample job 을 돌린 경험을 공유하고 있습니다.</p>

<blockquote>
<p>We deployed 1,000 pets. Technically with the Cassandra setup, <strong>we could have lost 333 nodes without service or data loss</strong>.<br />
<strong>8,072 Cores</strong>. The master used 24, minion nodes used the rest<br />
<strong>100,510 GB</strong> persistent disk used by the Minions and the Master<br />
<strong>380,020 GB SSD</strong> disk persistent disk. 20 GB for the master and 340 GB per Cassandra Pet.</p>
</blockquote>

<p><br/></p>

<p>팀 내에서 20+ broker 로 kafka cluster 를 운영하고 있는데다가 container 기반 기술에 관심이 많아 적용을 해보고 싶긴 한데,
아직 레퍼런스가 없어 안타깝습니다. github issue 를 보면 example 을 만들기 위해 논의는 진행중인것 같습니다.</p>

<ul>
<li><a href="https://github.com/kubernetes/kubernetes/issues/5017">kubernetes #5017: Example: Kafka/Zookeeper</a></li>
<li><a href="http://stackoverflow.com/questions/32140025/kafka-on-kubernetes-multi-node">SO: Kafka on k8s multi node</a></li>
<li><a href="http://www.defuze.org/archives/351-running-a-zookeeper-and-kafka-cluster-with-kubernetes-on-aws.html">Running a ZK and kafka clusters on k8s</a></li>
<li><a href="https://github.com/CloudTrackInc/kubernetes-kafka/issues">Github: kubernetes-kafka</a></li>
</ul>

<p><a href="https://github.com/kubernetes/contrib/tree/master/pets">Github: kubernetes-contrib/pets</a> 를 보시면 pet set 을 이용해 cluster 를 구성하는 샘플이 몇개 있습니다.
현재까지는 mysql, redis, ZK 정도가 있네요. <a href="https://github.com/kubernetes/kubernetes/tree/master/examples">Github: kubernetes/examples</a> 도 다양한 샘플이 있으므로 한번 쭈욱 둘러보시면 도움이 될듯 합니다.</p>

<p><br/></p>

<h3 id="other-objects">Other Objects</h3>

<ul>
<li><a href="http://kubernetes.io/docs/user-guide/volumes/">Volume</a>, <a href="http://kubernetes.io/docs/user-guide/persistent-volumes/">Persistent Volume</a></li>
</ul>

<p>위에서는 pod 과 volume 의 life cycle 이 동일하다고 했지만, 사실 꼭 그렇지는 않습니다. 다양한 type 의 volume 이 지원되기 때문인데요,
<code>emptyDir</code> 이외의 volume type 을 이용하면 pod 이 죽더라도, 데이터를 유지할 수 있습니다. (e.g <a href="http://kubernetes.io/docs/user-guide/volumes/#gcepersistentdisk">gcePersistentDisk</a>, <a href="https://clusterhq.com/flocker/introduction/">flocker</a>)</p>

<p>persistent volume (PV) 는 일종의 networked storage 로 pod lifecycle 을 벗어나 존재할수 있으면서도, 사용자가 리소스의 양을 특정지어 요청할 수 있는 volume 입니다.</p>

<blockquote>
<p>Managing storage is a distinct problem from managing compute. The PersistentVolume subsystem provides an API for users and administrators that abstracts details of how storage is provided from how it is consumed</p>
</blockquote>

<ul>
<li><a href="http://kubernetes.io/docs/admin/daemons/">Daemon Set</a></li>
</ul>

<p>daemon set 은 node 마다 추가되야 하는 프로세스가 있을때 사용할 수 있습니다.</p>

<blockquote>
<p>running a cluster storage daemon, such as <strong>glusterd</strong>, <strong>ceph</strong>, on each node<br />
running a logs collection daemon on every node, such as <strong>fluentd</strong> or <strong>logstash</strong><br />
&hellip;</p>
</blockquote>

<ul>
<li><a href="http://kubernetes.io/docs/user-guide/jobs/">Job</a></li>
</ul>

<p>배치 작업처럼, 실행후 종료되는 Job 을 의미합니다.</p>

<p>기타 오브젝트는 <a href="http://kubernetes.io/docs/reference/">Reference</a> 의 <a href="http://kubernetes.io/docs/user-guide/annotations/">Glossary</a> 를 참조하시면 됩니다.</p>

<p><br/></p>

<h3 id="etc">Etc</h3>

<p>A. Log Aggregation 은 아래의 내용을 참고하실 수 있습니다.</p>

<ul>
<li><a href="http://kubernetes.io/docs/getting-started-guides/logging/">http://kubernetes.io/docs/getting-started-guides/logging/</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/1071">https://github.com/kubernetes/kubernetes/issues/1071</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/24677">https://github.com/kubernetes/kubernetes/issues/24677</a></li>
</ul>

<p>B. k8s cluster 간 연결은 <a href="https://github.com/kubernetes/kubernetes/blob/master/docs/proposals/federation.md">k8s cluster federation</a> 이라 불립니다.</p>

<p>C. k8s production 적용을 위한 <a href="http://kubernetes.io/docs/user-guide/production-pods/#liveness-and-readiness-probes-aka-health-checks">guide</a> 도 있습니다.</p>

<p>D. 이런 저런 CI 를 테스팅 해봤는데 <a href="circleci.com">Circle CI</a> 가 썩 괜찮습니다.
싼 가격에, 연동 잘되고 기능 많습니다. 아래와 같이 build (scala) 세팅하면 <a href="https://cloud.google.com/container-registry/">google container registry</a> 에 push 하고
gcloud 커맨드 까지 직접 내릴 수 있으니, develop branch 정도라면 k8s <a href="kubernetes.io/docs/user-guide/deployments/">deployment</a> 이용해서 바로 롤링 업그레이드 가능합니다. (만약 SBT 가 느리다면 <a href="https://github.com/alexarchambault/coursier">courseir</a> 나 circle CI build cache 등을 이용해보세요.)</p>

<pre><code class="language-yaml">machine:
  environment:
    SBT_VERSION: 0.13.8
    SBT_OPTS: &quot;-Xms512M -Xmx1536M -Xss1M -XX:+CMSClassUnloadingEnabled
-XX:MaxPermSize=256M&quot;
    PROJECT_NAME: dmm-common
  services:
    - docker
  java:
    version: oraclejdk8

dependencies:
  cache_directories:
    - &quot;~/.sbt&quot;
  pre:
    # install SBT
    - wget --output-document=$HOME/bin/sbt-launch.jar
      https://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt-launch/&quot;$SBT_VERSION&quot;/sbt-launch.jar
    - echo &quot;java $SBT_OPTS -jar \`dirname \$0\`/sbt-launch.jar \&quot;\$@\&quot;&quot; &gt; $HOME/bin/sbt
    - chmod u+x $HOME/bin/sbt

    # install gcloud SDK, kubectl
    - sudo /opt/google-cloud-sdk/bin/gcloud --quiet components update
    - sudo /opt/google-cloud-sdk/bin/gcloud --quiet components update kubectl

  override:
    - sbt sbt-version

test:
  override:
    - sbt test
    - sbt docker

deployment:
  development:
    branch: /feature.*/
    commands:
      - echo $GCE_KEY &gt; gcloud-key.json
      - gcloud auth activate-service-account --key-file gcloud-key.json
      - docker tag 1ambda/sample gcr.io/1ambda/sample:$CIRCLE_SHA1
      - gcloud docker push gcr.io/1ambda/sample:$CIRCLE_SHA1
</code></pre>

<h2 id="references">References</h2>

<ul>
<li><a href="http://devops.com/2015/11/09/9-more-open-source-devops-tools-we-love/">Title Image</a></li>
<li><a href="http://kubernetes.io/docs/whatisk8s/">What is k8s?</a></li>
<li><a href="http://k8s.info/cs.html">k8s.info</a></li>
<li><a href="http://stackoverflow.com/questions/33970251/how-to-expose-a-kubernetes-service-externally-using-nodeport">SO: How to expose a Kubernetes service externally using NodePort</a></li>
<li><a href="http://nshani.blogspot.kr/2016/02/getting-started-with-kubernetes.html">k8s pod image</a></li>
<li><a href="http://www.slideshare.net/erialc_w/kubernetes-50626679">k8s architecture slide1</a></li>
<li><a href="http://www.slideshare.net/imesh/apache-stratos-410-architecture">k8s architecture slide2</a></li>
<li><a href="http://blog.kubernetes.io/2016/07/thousand-instances-of-cassandra-using-kubernetes-pet-set.html">1000 Instances of Cassandra using Kubernetes Pet Set</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/blob/release-1.3/docs/design/architecture.md">k8s design docs: Architecture</a></li>
</ul>

<p><br/></p>

<br/>
<br/>
<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = '1ambda';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      
      </div>
    </div>

    <div id="navigation">
        <a class="nav nav-prev" href="../../"> <i class="fa fa-chevron-left"></i></a>
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://1ambda.github.io/js/clipboard.min.js"></script>
    <script src="https://1ambda.github.io/js/perfect-scrollbar.min.js"></script>
    <script src="https://1ambda.github.io/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="https://1ambda.github.io/js/jquery.sticky-kit.min.js"></script>
    <script src="https://1ambda.github.io/js/featherlight.min.js"></script>
    <script src="https://1ambda.github.io/js/html5shiv-printshiv.min.js"></script>
    <script src="https://1ambda.github.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://1ambda.github.io/js/modernizr.custom.71422.js"></script>
    <script src="https://1ambda.github.io/js/learn.js"></script>
    <script src="https://1ambda.github.io/js/hugo-learn.js"></script>
    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-52181619-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


  </body>
</html>


